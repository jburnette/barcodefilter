#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Instructions for importing CCS sequences
\end_layout

\begin_layout Date
August 10, 2018
\end_layout

\begin_layout Part*
Overview
\end_layout

\begin_layout Standard
Describe the process here.
 
\end_layout

\begin_layout Standard
Primer order is critical.
 The barcoded primers are aliquoted into 96-well plates with the forward
 primers (the ones with M13F seuqence) in rows (
\emph on
e.g.
\emph default
, A1-A12) and reverse primers (M13R sequence) in columns (
\emph on
e.g.
\emph default
, A1-H1).
 There should be no spaces in the primer names.
 Primers must be used in combinations that the primer pair and PCR plate
 name/number is unique.
 
\end_layout

\begin_layout Section*
Running BarCode Filter
\end_layout

\begin_layout Subsection*
System requirements
\end_layout

\begin_layout Itemize
PHP 5.0 or greater with PDO::sqlite3 
\end_layout

\begin_layout Itemize
Sqlite3
\end_layout

\begin_layout Itemize
Apache server
\end_layout

\begin_layout Itemize
PHP scripts:
\end_layout

\begin_deeper
\begin_layout Itemize
filter7.php
\end_layout

\begin_layout Itemize
splitReads7.php
\end_layout

\begin_layout Itemize
functions.php
\end_layout

\begin_layout Itemize
make_plate5.php
\end_layout

\begin_layout Itemize
load_fasta.php
\end_layout

\begin_layout Itemize
get_fasta5.php
\end_layout

\begin_layout Itemize
collapser.php
\end_layout

\end_deeper
\begin_layout Itemize
FASTX-Toolkit: http://hannonlab.cshl.edu/fastx_toolkit
\end_layout

\begin_layout Itemize
BLAST+
\end_layout

\begin_layout Subsection*
Required Files
\end_layout

\begin_layout Description
PacBioBarcodedPrimers.csv This file contains the location of the primers
 in the storage plate without PCR plate designation.
 This file can have all primers on hand not just the ones used in a particular
 sequencing run.
 the CSV must have these columns (exactly as written here): 
\emph on
Name, Primer, Direction, Well.
 
\emph default
The Primer column is for the barcode portion of the primer only omitting
 the M13F or M13R sequence.
\end_layout

\begin_layout Description
primers.csv A CSV file with these columns: 
\emph on
primer_name, seq, direction, plate_name
\emph default
.
 Primers must be entered in the spreadsheet in order by plate.
 
\end_layout

\begin_layout Description
seqs.fasta A multiple FASTA file with the circularized consensus sequences
 generated by the PacBio software.
\end_layout

\begin_layout Subsection*
PHP Scripts
\end_layout

\begin_layout Description
load_fasta.php A script that creates the sqlite3 database and a table called
 
\emph on
seqs.
 
\emph default
The CCS sequences are inserted into the 
\emph on
seqs
\emph default
 table.
 
\end_layout

\begin_layout Description
filter7.php This script, along with 
\emph on
split_reads7.php
\emph default
, sorts the sequences to original wells.
 Using BLAST the barcode primers are identified.
 This infromation is passed to split_reads7.php.
\end_layout

\begin_layout Description
split_reads7.php Using primer information identified by filter7.php, split_reads
 determines if the read is a singleton or concatamer of two or more sequences.
 The concatermers form during the ligation step of library construction.
 If it is a concatemer split_reads will attempt to split it apart.
 The individual sequences are then assigned to individual wells and the
 primer sequence is trimmed from the read.
 The read is stored in a database table called output along with the primers
 identified.
 
\end_layout

\begin_layout Description
collapser.php Using the fastx command FASTQ/A Collapser all reads in a well
 are 
\begin_inset Quotes eld
\end_inset

collapsed
\begin_inset Quotes erd
\end_inset

 where all indentical reads are reduced to one sequence with the number
 of reads representing the sequence in the comment line.
 For example if 40 out of 400 reads are idnetical the 40 reads are replaced
 with one and the number 40 is placed in the fasta comment line (>1-40 where
 1 is the first seuqnece analyzed and 40 is the read depth).
 This usually results in two 
\begin_inset Quotes eld
\end_inset

alleles
\begin_inset Quotes erd
\end_inset

 (if the organism is diploid) supported by a large depth and a bunch of
 singletons.The results are stored in the 
\emph on
collapsed
\emph default
 database table.
\end_layout

\begin_layout Description
make_plate5.php After all of the reads are assigned to individual wells make_plat
e5 is run to sort the reads for access through a webpage.
 Two tables per original plate are generated.
 One table contains links to the sequences both collapsed and uncollapsed.
 The second table contains the read depth for that particular well.
 Ths output of make_plate5 is html.
\end_layout

\begin_layout Description
get_fasta5.php When a user clicks on either 
\begin_inset Quotes eld
\end_inset

All
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

Collapsed
\begin_inset Quotes erd
\end_inset

 this script is called to generate a fasta formatted output of the reads
 for that well.
 The results opens in a separate browser window.
\end_layout

\begin_layout Description
\begin_inset Graphics
	filename /Users/jamesburnette/Desktop/Screen Shot 2018-08-13 at 11.15.48 AM.png
	lyxscale 50
	scale 50

\end_inset


\end_layout

\begin_layout Subsection*
Process for running BarCode Filter
\end_layout

\begin_layout Enumerate
Create the PacBioBarcodedPrimers.csv file.
 This only needs to be done once and should not change unless the order
 of the primers changes.
\end_layout

\begin_layout Enumerate
Generate the primer.csv file.
 This must be done for every sequencing run because the primer combinations
 may be different.
\end_layout

\end_body
\end_document
